<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>帮助支持 - 飞书-Notion同步系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <style>
        /* 自定义标签页样式 */
        .nav-tab {
            transition: all 0.3s ease;
            border-radius: 0.5rem;
        }
        .nav-tab.active {
            background: linear-gradient(135deg, #1E40AF, #3B82F6);
            color: white;
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
        }
        .nav-tab:not(.active):hover {
            background-color: #F3F4F6;
            transform: translateY(-1px);
        }
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }
        .tab-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* 确保页面滚动时标签页固定 */
        .nav-tabs-container {
            position: sticky;
            top: 0;
            z-index: 10;
            background: white;
            padding: 1rem 0;
        }
        /* 确保底部有足够的间距 */
        .content-container {
            padding-bottom: 8rem;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 content-container">
        <div class="mb-6">
            <a href="/" class="inline-flex items-center text-blue-600 hover:text-blue-800 font-medium transition-colors">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                </svg>
                返回首页
            </a>
        </div>
        
        <!-- 页头 -->
        <div class="bg-white rounded-xl shadow-lg p-8 mb-8 text-center border-t-4 border-blue-600">
            <h1 class="text-4xl font-bold text-blue-600 mb-4">帮助支持中心</h1>
            <p class="text-xl text-gray-600 mb-6">飞书-Notion双向同步系统完整指南</p>
            <div class="inline-flex items-center bg-blue-50 text-blue-700 px-6 py-3 rounded-full text-sm font-medium">
                <span class="w-3 h-3 bg-green-500 rounded-full mr-3 animate-pulse"></span>
                当前版本: v2.4.5 | 发布日期: 2025-07-11 | 系统状态: 正常运行
            </div>
        </div>

        <!-- 导航标签页 -->
        <div class="nav-tabs-container bg-white rounded-xl shadow-sm mb-8">
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-2 p-4">
                <button class="nav-tab active px-4 py-3 text-sm font-medium text-center" onclick="showTab(event, 'quick-start')">
                    🚀 快速开始
                </button>
                <button class="nav-tab px-4 py-3 text-sm font-medium text-center" onclick="showTab(event, 'user-guide')">
                    📖 使用指南
                </button>
                <button class="nav-tab px-4 py-3 text-sm font-medium text-center" onclick="showTab(event, 'faq')">
                    ❓ 常见问题
                </button>
                <button class="nav-tab px-4 py-3 text-sm font-medium text-center" onclick="showTab(event, 'troubleshooting')">
                    🔧 故障排除
                </button>
                <button class="nav-tab px-4 py-3 text-sm font-medium text-center" onclick="showTab(event, 'version-history')">
                    📋 版本历史
                </button>
                <button class="nav-tab px-4 py-3 text-sm font-medium text-center" onclick="showTab(event, 'support')">
                    📞 技术支持
                </button>
            </div>
        </div>

        <!-- 快速开始 -->
        <div id="quick-start" class="tab-content active">
            <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h2 class="text-2xl font-bold text-blue-600 mb-6 border-l-4 border-blue-600 pl-4">🚀 快速开始指南</h2>
                
                <h3 class="text-lg font-semibold text-gray-700 mt-6 mb-4">环境要求</h3>
                <ul class="list-disc pl-6 space-y-2 text-gray-600">
                    <li><strong>Python</strong>: 3.6+ (推荐 3.8+)</li>
                    <li><strong>数据库</strong>: SQLite 3.0+ (默认) 或 MySQL 5.7+</li>
                    <li><strong>内存</strong>: 最小 512MB，推荐 1GB+</li>
                    <li><strong>网络</strong>: 稳定的互联网连接</li>
                </ul>

                <h3 class="text-lg font-semibold text-gray-700 mt-6 mb-4">安装步骤</h3>
                <div class="bg-green-50 border-l-4 border-green-500 p-6 rounded-lg">
                    <ol class="list-decimal space-y-4 text-gray-700">
                        <li><strong>克隆项目</strong>
                            <div class="bg-gray-100 border border-gray-300 rounded-lg p-4 mt-2 font-mono text-sm overflow-x-auto">git clone https://github.com/yian20133213/feishu-notion-sync.git
cd feishu-notion-sync</div>
                        </li>
                        <li><strong>创建虚拟环境</strong>
                            <div class="bg-gray-100 border border-gray-300 rounded-lg p-4 mt-2 font-mono text-sm overflow-x-auto">python3 -m venv venv
source venv/bin/activate  # Linux/Mac</div>
                        </li>
                        <li><strong>安装依赖</strong>
                            <div class="bg-gray-100 border border-gray-300 rounded-lg p-4 mt-2 font-mono text-sm overflow-x-auto">pip install -r requirements.txt</div>
                        </li>
                        <li><strong>配置环境变量</strong>
                            <div class="bg-gray-100 border border-gray-300 rounded-lg p-4 mt-2 font-mono text-sm overflow-x-auto">cp .env.example .env
# 编辑 .env 文件，配置API密钥</div>
                        </li>
                        <li><strong>初始化数据库</strong>
                            <div class="bg-gray-100 border border-gray-300 rounded-lg p-4 mt-2 font-mono text-sm overflow-x-auto">python database/init_db.py</div>
                        </li>
                        <li><strong>启动服务</strong>
                            <div class="bg-gray-100 border border-gray-300 rounded-lg p-4 mt-2 font-mono text-sm overflow-x-auto">python app.py</div>
                        </li>
                        <li><strong>访问系统</strong><br>
                            打开浏览器访问: <code class="bg-gray-200 px-2 py-1 rounded text-sm">http://localhost:5000</code>
                        </li>
                    </ol>
                </div>

                <h3 class="text-lg font-semibold text-gray-700 mt-6 mb-4">必需的API配置</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4">
                    <div class="bg-cyan-50 border-l-4 border-cyan-500 p-6 rounded-lg">
                        <h4 class="text-cyan-700 font-semibold mb-3">飞书API配置</h4>
                        <p class="text-sm text-gray-600 mb-2"><strong>FEISHU_APP_ID</strong>: 飞书应用ID</p>
                        <p class="text-sm text-gray-600 mb-2"><strong>FEISHU_APP_SECRET</strong>: 飞书应用密钥</p>
                    </div>
                    <div class="bg-cyan-50 border-l-4 border-cyan-500 p-6 rounded-lg">
                        <h4 class="text-cyan-700 font-semibold mb-3">Notion API配置</h4>
                        <p class="text-sm text-gray-600 mb-2"><strong>NOTION_TOKEN</strong>: Notion集成令牌</p>
                    </div>
                    <div class="bg-cyan-50 border-l-4 border-cyan-500 p-6 rounded-lg">
                        <h4 class="text-cyan-700 font-semibold mb-3">七牛云存储配置</h4>
                        <p class="text-sm text-gray-600 mb-1"><strong>QINIU_ACCESS_KEY</strong>: 访问密钥</p>
                        <p class="text-sm text-gray-600 mb-1"><strong>QINIU_SECRET_KEY</strong>: 安全密钥</p>
                        <p class="text-sm text-gray-600 mb-2"><strong>QINIU_CDN_DOMAIN</strong>: CDN域名</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 使用指南 -->
        <div id="user-guide" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h2 class="text-2xl font-bold text-blue-600 mb-6 border-l-4 border-blue-600 pl-4">📖 功能使用指南</h2>
                
                <h3 class="text-lg font-semibold text-gray-700 mt-6 mb-4">核心功能概览</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                    <div class="bg-cyan-50 border-l-4 border-cyan-500 p-6 rounded-lg">
                        <h4 class="text-cyan-700 font-semibold mb-3">🔄 双向同步</h4>
                        <p class="text-sm text-gray-600">支持飞书↔Notion双向内容同步，保持文档一致性</p>
                    </div>
                    <div class="bg-cyan-50 border-l-4 border-cyan-500 p-6 rounded-lg">
                        <h4 class="text-cyan-700 font-semibold mb-3">⚡ 实时同步</h4>
                        <p class="text-sm text-gray-600">基于Webhook的实时自动同步机制</p>
                    </div>
                    <div class="bg-cyan-50 border-l-4 border-cyan-500 p-6 rounded-lg">
                        <h4 class="text-cyan-700 font-semibold mb-3">🖼️ 图片处理</h4>
                        <p class="text-sm text-gray-600">自动图片上传、格式优化、CDN加速</p>
                    </div>
                    <div class="bg-cyan-50 border-l-4 border-cyan-500 p-6 rounded-lg">
                        <h4 class="text-cyan-700 font-semibold mb-3">🎛️ 管理界面</h4>
                        <p class="text-sm text-gray-600">可视化配置管理、状态监控、批量操作</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 常见问题 -->
        <div id="faq" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h2 class="text-2xl font-bold text-blue-600 mb-6 border-l-4 border-blue-600 pl-4">❓ 常见问题解答</h2>
                
                <div class="space-y-6">
                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-6 rounded-lg">
                        <div class="font-semibold text-gray-700 mb-2">Q: 系统支持哪些文档格式？</div>
                        <div class="text-gray-600">A: 支持飞书文档(.docx)、Notion页面，包括富文本、图片、标题、列表、代码块、链接等格式。暂不支持表格、数据库等复杂结构。</div>
                    </div>
                    
                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-6 rounded-lg">
                        <div class="font-semibold text-gray-700 mb-2">Q: 为什么同步失败显示权限不足？</div>
                        <div class="text-gray-600">A: 请检查飞书应用是否具有文档读取权限，Notion集成是否被邀请到目标页面。</div>
                    </div>
                    
                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-6 rounded-lg">
                        <div class="font-semibold text-gray-700 mb-2">Q: 如何设置自动同步？</div>
                        <div class="text-gray-600">A: 在同步配置中启用"自动同步"选项，系统会在文档变更时自动触发同步。需要正确配置飞书Webhook回调地址。</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 故障排除 -->
        <div id="troubleshooting" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h2 class="text-2xl font-bold text-blue-600 mb-6 border-l-4 border-blue-600 pl-4">🔧 故障排除指南</h2>
                
                <h3 class="text-lg font-semibold text-gray-700 mt-6 mb-4">常见错误代码</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                        <div class="font-semibold text-red-600">401 Unauthorized</div>
                        <p class="text-sm text-gray-600">API密钥错误或过期，请检查.env文件中的API凭据</p>
                    </div>
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                        <div class="font-semibold text-red-600">403 Forbidden</div>
                        <p class="text-sm text-gray-600">权限不足，确认应用权限和文档访问权限</p>
                    </div>
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                        <div class="font-semibold text-red-600">429 Too Many Requests</div>
                        <p class="text-sm text-gray-600">API调用频率超限，等待或调整同步频率</p>
                    </div>
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                        <div class="font-semibold text-red-600">500 Internal Server Error</div>
                        <p class="text-sm text-gray-600">服务器内部错误，查看系统日志，重启服务</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 版本历史 -->
        <div id="version-history" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h2 class="text-2xl font-bold text-blue-600 mb-6 border-l-4 border-blue-600 pl-4">📋 版本历史记录</h2>
                
                <div class="space-y-6">
                    <div class="bg-purple-50 border-l-4 border-purple-500 p-6 rounded-lg">
                        <div class="flex justify-between items-center mb-4">
                            <div>
                                <span class="text-lg font-semibold text-purple-600">v2.4.5</span>
                                <span class="ml-2 bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs">UI优化</span>
                            </div>
                            <div class="text-sm text-gray-500">2025-07-11</div>
                        </div>
                        <h4 class="font-semibold mb-2">🎯 前端分页系统重构与UI优化</h4>
                        <ul class="list-disc pl-5 space-y-1 text-sm text-gray-600">
                            <li>修复分页控件点击事件失效问题</li>
                            <li>优化事件绑定机制，防止重复绑定</li>
                            <li>移除右下角版本历史悬浮球干扰元素</li>
                            <li>优化页面层级管理，建立清晰的z-index体系</li>
                        </ul>
                    </div>
                    
                    <div class="bg-purple-50 border-l-4 border-purple-500 p-6 rounded-lg">
                        <div class="flex justify-between items-center mb-4">
                            <div>
                                <span class="text-lg font-semibold text-purple-600">v2.4.4</span>
                                <span class="ml-2 bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs">文档完善</span>
                            </div>
                            <div class="text-sm text-gray-500">2025-07-10</div>
                        </div>
                        <h4 class="font-semibold mb-2">📚 完善项目文档体系和知识管理</h4>
                        <ul class="list-disc pl-5 space-y-1 text-sm text-gray-600">
                            <li>新增VERSION_HISTORY.md完整版本历史记录系统</li>
                            <li>新增KNOWLEDGE_BASE.md开发最佳实践知识库</li>
                            <li>建立语义化版本控制规范</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- 技术支持 -->
        <div id="support" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h2 class="text-2xl font-bold text-blue-600 mb-6 border-l-4 border-blue-600 pl-4">📞 技术支持</h2>
                
                <h3 class="text-lg font-semibold text-gray-700 mt-6 mb-4">联系方式</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-gray-50 p-6 rounded-lg text-center border-2 border-gray-200">
                        <h4 class="text-blue-600 font-semibold mb-3">📧 问题反馈</h4>
                        <p class="text-sm text-gray-600 mb-2">通过GitHub Issues报告问题</p>
                        <p class="text-xs text-gray-500">响应时间: 1-3个工作日</p>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg text-center border-2 border-gray-200">
                        <h4 class="text-blue-600 font-semibold mb-3">💬 功能建议</h4>
                        <p class="text-sm text-gray-600 mb-2">通过GitHub Discussions讨论</p>
                        <p class="text-xs text-gray-500">响应时间: 实时交流</p>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg text-center border-2 border-gray-200">
                        <h4 class="text-blue-600 font-semibold mb-3">📖 文档改进</h4>
                        <p class="text-sm text-gray-600 mb-2">欢迎提交PR改进文档</p>
                        <p class="text-xs text-gray-500">响应时间: 1-2个工作日</p>
                    </div>
                </div>

                <h3 class="text-lg font-semibold text-gray-700 mt-8 mb-4">常用检查命令</h3>
                <div class="bg-gray-100 border border-gray-300 rounded-lg p-4 font-mono text-sm overflow-x-auto">
# 检查服务状态
ps aux | grep "python app.py"

# 检查端口占用
lsof -i :5000

# 检查系统健康状态
curl http://localhost:5000/health
                </div>
            </div>
        </div>
    </div>

    <script>
        function showTab(evt, tabName) {
            console.log('点击标签页:', tabName);
            
            // 隐藏所有标签页内容
            const tabContent = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabContent.length; i++) {
                tabContent[i].classList.remove("active");
            }
            
            // 移除所有标签按钮的active类
            const tabLinks = document.getElementsByClassName("nav-tab");
            for (let i = 0; i < tabLinks.length; i++) {
                tabLinks[i].classList.remove("active");
            }
            
            // 显示选中的标签页内容并标记按钮为active
            const targetTab = document.getElementById(tabName);
            if (targetTab) {
                targetTab.classList.add("active");
                console.log('显示标签页:', tabName);
            } else {
                console.error('未找到标签页:', tabName);
            }
            
            if (evt && evt.currentTarget) {
                evt.currentTarget.classList.add("active");
                console.log('激活按钮:', evt.currentTarget.textContent);
            }
            
            // 防止默认行为和事件冒泡
            if (evt) {
                evt.preventDefault();
                evt.stopPropagation();
            }
        }
        
        // 页面加载完成后的初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('页面加载完成，初始化帮助页面');
            
            // 为标签按钮添加点击事件（防重复绑定）
            const tabButtons = document.querySelectorAll('.nav-tab');
            tabButtons.forEach((button, index) => {
                if (!button.hasAttribute('data-listener-bound')) {
                    button.addEventListener('click', function() {
                        console.log('标签按钮点击事件触发，按钮索引:', index);
                        // 标签页切换时滚动到顶部
                        setTimeout(() => {
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                        }, 100);
                    });
                    button.setAttribute('data-listener-bound', 'true');
                }
            });
            
            console.log('帮助页面初始化完成');
        });
    </script>
</body>
</html>